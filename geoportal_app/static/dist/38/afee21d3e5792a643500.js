(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{890:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(53);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u={createEmployee:function(e,t,n,o){var i=a(a({},Object(r.b)()),{},{body:JSON.stringify({user_detail:e,emp_role_id:t,roles:n,address:o})});return fetch("".concat(c,"/create/"),i).then(r.c)},getRole:function(e){var t=a({},Object(r.a)());return fetch("".concat("/gov/api/role","/").concat(e,"/detail/"),t).then(r.c)},getRoleList:function(){var e=a({},Object(r.a)());return fetch("".concat("/gov/api/role","/"),e).then(r.c)},getDetailEmployee:function(e){var t=a({},Object(r.a)());return fetch("".concat(c,"/").concat(e,"/detail/"),t).then(r.c)},deleteEmployee:function(e){var t=a({},Object(r.a)());return fetch("".concat(c,"/").concat(e,"/delete/"),t).then(r.c)},updateEmployee:function(e,t,n,o,i,u,l,s,f,p,d,m,h,y){var g=a(a({},Object(r.b)()),{},{body:JSON.stringify({username:e,first_name:t,last_name:n,position:o,email:i,gender:u,register:l,phone_number:s,is_admin:f,role_id:p,id:d,add_perm:m,remove_perm:h,address:y})});return fetch("".concat(c,"/").concat(d,"/update/"),g).then(r.c)},empTokenRefresh:function(e){var t=a({},Object(r.a)());return fetch("".concat(c,"/").concat(e,"/refresh-token/"),t).then(r.c)},sendMail:function(e){var t=a(a({},Object(r.b)()),{},{body:JSON.stringify({username:e})});return fetch("".concat(c,"/send-mail/"),t).then(r.c)},getGeom:function(e){var t=a(a({},Object(r.b)()),{},{body:JSON.stringify({geo_id:e})});return fetch("/payment/get-geom/",t).then(r.c)},getAddresses:function(){var e=a({},Object(r.a)());return fetch("".concat(c,"/addresses/"),e).then(r.c)},formOptions:function(){var e=a({},Object(r.a)());return fetch("/api/aimag/",e).then(r.c)},getEmpInfo:function(e,t){var n=a(a({},Object(r.b)()),{},{body:JSON.stringify({is_erguul:t})});return fetch("/back/api/org/".concat(e,"/emp-info/"),n).then(r.c)},getErguulegFields:function(e){var t=a({},Object(r.a)());return fetch("/back/api/org/".concat(e,"/erguuleg-fields/"),t).then(r.c)},saveErguul:function(e,t,n,o,i){var u=a(a({},Object(r.b)()),{},{body:JSON.stringify({values:e,emp_id:t,point:n,photo:o,erguul_id:i})});return fetch("/back/api/org/save-erguul/",u).then(r.c)},getFieldTailbar:function(){var e=a({},Object(r.a)());return fetch("".concat(c,"/get-field-tailbar/"),e).then(r.c)},saveTailbar:function(e,t){var n=a(a({},Object(r.b)()),{},{body:JSON.stringify({values:e,id:t})});return fetch("".concat(c,"/save-field-tailbar/"),n).then(r.c)},getErguul:function(){var e=a({},Object(r.a)());return fetch("".concat(c,"/get-erguul/"),e).then(r.c)}},c="/gov/api/role/employee"},948:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return Qe}));var r=n(0),o=n.n(r),a=n(49),i=n(879),u=n(468),c=n(115),l=n(284),s=n(880),f=n(282),p=n(162),d=n(2),m=n(136),h=n(235),y=n(212),g=n(332),v=n(883),b=n(16),_=n(84),O=n(527),E=n(528),w=n(334),S=n(878),j=n(7),k=n.n(j),P=n(76);function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function F(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function N(e,t,n){return t&&x(e.prototype,t),n&&x(e,n),e}function R(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=V(e);if(t){var o=V(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return L(this,n)}}function L(e,t){return!t||"object"!==C(t)&&"function"!=typeof t?A(e):t}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function V(e){return(V=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var G=function(e){R(n,e);var t=D(n);function n(e){var r;return F(this,n),(r=t.call(this,e)).input_data={},r.state={input_value:""},r}return N(n,[{key:"componentDidUpdate",value:function(e,t){e.value!==this.props.value&&this.setState({input_value:this.props.value})}},{key:"handleOnChange",value:function(e){var t=this.props,n=t.idx,r=(t.ix,t.field,t.length,t.origin_name);this.setState({input_value:e}),this.props.getValues(e,n,r)}},{key:"render",value:function(){var e=this,t=this.props,n=t.idx,r=(t.ix,t.field),a=t.length,i=t.choices,u=t.value,c=t.disabled,l=t.type,s=t.is_detail,f=this.state.input_value;return o.a.createElement("div",{className:"form-group animated slideInLeft"},o.a.createElement("dt",null,r),s?o.a.createElement("dd",null,u):"date"==l&&null==i?o.a.createElement("input",{type:l,maxLength:a,className:"form-control",disabled:c,value:f,onChange:function(t){return e.handleOnChange(t.target.value)}}):a>1900&&null==i?o.a.createElement("textarea",{className:"form-control",rows:"3",onChange:function(t){return e.handleOnChange(t.target.value)},maxLength:a,disabled:c,placeholder:u,value:f}):a<1900&&null==i?o.a.createElement("input",{type:"text",maxLength:a,className:"form-control",disabled:c,value:f,onChange:function(t){return e.handleOnChange(t.target.value)},placeholder:r+" оруулна уу"}):null!==i?o.a.createElement("select",{className:"form-control",disabled:c,onChange:function(t){return e.handleOnChange(t.target.value)},value:f},o.a.createElement("option",{key:n,value:""},"--- Сонгоно уу ---"),i.map((function(e,t){return o.a.createElement("option",{key:t,value:e[0]},e[1])}))):null)}}]),n}(r.Component),M=function(e){R(n,e);var t=D(n);function n(e){var r;return F(this,n),(r=t.call(this,e)).state={values:{}},r.getValues=r.getValues.bind(A(r)),r}return N(n,[{key:"getValues",value:function(e,t,n){var r=this.state.values;r[n]=e,this.setState({values:r})}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.props,n=t.fields,r=t.is_detail,a=t.title,i=t.button_name,u=this.state.values;return o.a.createElement("div",null,o.a.createElement("div",{className:"row text-center"},o.a.createElement("div",{className:"col-md-10"},o.a.createElement("h6",null,a)),o.a.createElement("div",{className:"col-md-2"},o.a.createElement("button",{type:"button",className:"close"},o.a.createElement("span",{"aria-hidden":"true",onClick:function(){return e.props.handleClose()}},"×")))),o.a.createElement("div",{className:"overflow-auto",style:{maxHeight:"calc( 50vh - 70px - 15px)"}},n.map((function(t,n){return o.a.createElement(G,{key:n,is_detail:r,field:t.name,length:t.length,disabled:t.disabled,idx:n,origin_name:t.origin_name,getValues:e.getValues,value:t.value,choices:t.choices,type:t.type})}))),r?o.a.createElement("div",{className:"pb-2"}):o.a.createElement("div",{className:"pb-2"},o.a.createElement("button",{className:"btn btn-primary btn-block",onClick:function(){return e.props.saveErguulPlace(u)}},i)))}}]),n}(r.Component),I=function(e){R(n,e);var t=D(n);function n(e){var r;F(this,n);var o=e||{};(r=t.call(this,{element:document.createElement("div"),target:o.target})).is_component_initialized=!1;return r.element.className="col-md-3 card",r.element.style.display="none",r.element.style.height="auto",r.renderComponent=r.renderComponent.bind(A(r)),r.toggleControl=r.toggleControl.bind(A(r)),r}return N(n,[{key:"toggleControl",value:function(e){this.element.style.display=e?"block":"none"}},{key:"renderComponent",value:function(e){var t=this;e.handleClose=function(){t.toggleControl(!1)},this.is_component_initialized||(k.a.render(o.a.createElement(M,e),this.element),this.is_component_initialized=!0),k.a.hydrate(o.a.createElement(M,e),this.element)}},{key:"showForm",value:function(e,t,n,r,o){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.toggleControl(e),this.renderComponent({fields:t,title:n,is_detail:a,saveErguulPlace:r,button_name:o})}}]),n}(P.a),J=(n(215),n(890));function z(e){return(z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function U(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function W(e,t){return(W=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function B(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Y(e);if(t){var o=Y(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return q(this,n)}}function q(e,t){return!t||"object"!==z(t)&&"function"!=typeof t?H(e):t}function H(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Y(e){return(Y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&W(e,t)}(j,e);var t,n,r,a=B(j);function j(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,j),(t=a.call(this,e)).state={projection_data:"EPSG:4326",projection_display:"EPSG:3857"},t.controls={form:new I},t.loadMap=t.loadMap.bind(H(t)),t.readFeatures=t.readFeatures.bind(H(t)),t.readFeature=t.readFeature.bind(H(t)),t.removeFeatureFromSource=t.removeFeatureFromSource.bind(H(t)),t.translateStart=t.translateStart.bind(H(t)),t.translateEnd=t.translateEnd.bind(H(t)),t.selectedFeature=t.selectedFeature.bind(H(t)),t.getEmpInfo=t.getEmpInfo.bind(H(t)),t.changedFeatureSetColor=t.changedFeatureSetColor.bind(H(t)),t.makeLineString=t.makeLineString.bind(H(t)),t.sendErguuleg=t.sendErguuleg.bind(H(t)),t.downloadImage=t.downloadImage.bind(H(t)),t}return t=j,(n=[{key:"componentDidMount",value:function(){this.loadMap()}},{key:"componentDidUpdate",value:function(e,t){e.features!==this.props.features&&this.readFeatures(this.props.features),e.feature!==this.props.feature&&this.props.feature!=={}&&this.readFeature(this.props.feature)}},{key:"loadMap",value:function(){var e=this,t=new f.a({source:new l.a({}),style:new m.c({stroke:new h.a({color:"rgba(100, 255, 0, 1)",width:2}),fill:new y.a({color:"rgba(100, 255, 0, 0.3)"})})});this.vector_layer=t;var n=new O.a;n.on("select",(function(t){return e.selectedFeature(t)})),this.select=n;var r=new E.a({features:n.getFeatures()});r.on("translatestart",(function(t){return e.translateStart(t)})),r.on("translateend",(function(t){return e.translateEnd(t)})),this.translate=r;var o=new i.a({interactions:Object(w.a)().extend([n,r]),layers:[new p.a({source:new s.a}),t],target:"map",view:new u.a({center:[11461613.630815497,5878656.0228370065],zoom:5.041301562246971}),controls:[]});o.addControl(this.controls.form),this.map=o}},{key:"makeFields",value:function(e,t){var n=Array();return Object.keys(e).map((function(r,o){t.map((function(t,o){if(r==t.origin_name){var a=Object();a.name=t.name,a.origin_name=r,a.value=e[r]?e[r]:"",a.disabled=t.disabled,a.choices=null,a.length=t.length,"level_1"==r&&(a.value=e.level_1+", "+e.level_2+", "+e.level_3+", "+e.street+" гудамж "+e.apartment+" байр, "+e.door_number+" тоот"),n.push(a)}}))})),n}},{key:"getEmpInfo",value:function(e,t){var n=this;t||(t=!1),J.a.getEmpInfo(e,t).then((function(e){var t=e.success,r=e.info,o=e.title;if(t){var a=n.makeFields(r,[{origin_name:"org_name",name:"Байгууллагын нэр",disabled:!0,length:100},{origin_name:"phone_number",name:"Утасны дугаар",disabled:!0,length:100},{origin_name:"level_1",name:"Гэрийн хаяг",disabled:!0,length:2e3},{origin_name:"last_name",name:"Овог",disabled:!0,length:100},{origin_name:"first_name",name:"Нэр",disabled:!0,length:100},{origin_name:"date_start",name:"Эхлэх огноо",disabled:!0,length:100},{origin_name:"date_end",name:"Дуусах огноо",disabled:!0,length:100},{origin_name:"part_time",name:"Ээлж",disabled:!0,length:100},{origin_name:"erguul_address",name:"Эргүүлийн хаяг",disabled:!0,length:100}]);n.controls.form.showForm(!0,a,o,void 0,"",!0)}}))}},{key:"featureWithTextStyle",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"red",n=new m.c({image:new g.a({radius:5,fill:new y.a({color:t})}),text:new v.a({text:e,font:"30px Calibri,sans-serif",stroke:new h.a({color:"white",width:3}),offsetY:-18})});return n}},{key:"changedFeatureSetColor",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"green",n=this.vector_layer.getSource();n.getFeatures().map((function(n,r){if(n.getProperties().is_changed){var o=e.getFullName(n),a=e.featureWithTextStyle(o,t);n.setStyle(a)}}))}},{key:"getFullName",value:function(e){var t=e.getProperties().first_name;return e.getProperties().last_name.charAt(0).toUpperCase()+". "+(t.charAt(0).toUpperCase()+t.slice(1))}},{key:"selectedFeature",value:function(e){this.translate.setActive(!0);var t=e.selected[0];if(t)if("Point"==t.getGeometry().getType()&&this.props.is_admin){var n=t.getProperties(),r=n.id;this.id=r,n.is_cloned&&this.translate.setActive(!1),this.getEmpInfo(r,n.is_erguul)}else this.select.getFeatures().clear();else this.changedFeatureSetColor()}},{key:"translateStart",value:function(e){var t=0,n=this.vector_layer.getSource(),r=e.features.getArray()[0],o=r.getProperties().id,a=n.getFeatures();if(null!=a&&a.length>0)for(var i=0;i<a.length;i++)if(a[i].getProperties().id==o&&t<2)t++;else if(2==t)break;if(t<2){var u=r.clone(),c=this.getFullName(u),l=this.featureWithTextStyle(c);u.setStyle(l),u.setProperties({is_cloned:!0}),n.addFeature(u)}r.setProperties({is_changed:!0})}},{key:"translateEnd",value:function(e){var t=this,n=e.features.getArray()[0],r=n.getGeometry().getCoordinates();this.end_coordinates=r;var o=n.getProperties().id;this.removeFeatureFromSource(o);var a=this.map.getView().getProjection(),i=Object(d.p)(r,a,this.state.projection_data),u=Object(b.f)(i,"{y},{x}",6);this.changedFeatureSetColor(),J.a.getErguulegFields(o).then((function(e){var r=e.success,o=e.info,a=e.erguul_id;t.makeLineString([n],"one");var i="Хадгалах";a&&(i="Засах"),t.controls.form.showForm(r,o,"Эргүүлд гарах байршил",(function(e){return t.sendErguuleg(e,t.id,u,a)}),i)}))}},{key:"fromLonLatToMapCoord",value:function(e){return Object(d.d)([e[0],e[1]])}},{key:"makeLineString",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=this.vector_layer.getSource(),o=r.getFeatures();if(null!=o&&o.length>0&&e.length>0)for(var a=function(){var a=o[i],u=a.getProperties(),l=u.id,s=void 0;s="one"==n?u.is_cloned:u.is_erguul,l&&s&&e.map((function(e,o){var i,u;u="one"==n?(i=e.getProperties()).is_changed:(i=e.properties).is_cloned;var s=i.id;if(s==l&&u){var f;"one"==n?f=e.getGeometry().getCoordinates():(f=e.geometry.coordinates,f=t.fromLonLatToMapCoord(f));var p=a.getGeometry().getCoordinates(),d=new _.a([f,p]),m=new c.a(d);m.setProperties({id:s});var h=m.getGeometry().getExtent();t.extent=h,t.props.is_admin||t.map.getView().fit(h,{padding:[200,200,200,200]}),r.addFeature(m)}}))},i=0;i<o.length;i++)a()}},{key:"downloadImage",value:function(e,t,n,r){var o,a=this,i=this.map;this.props.setLoading(!0),i.once("rendercomplete",(function(){var u=document.createElement("canvas"),c=i.getSize();u.width=c[0],u.height=c[1];var l=u.getContext("2d");Array.prototype.forEach.call(document.querySelectorAll(".ol-layer canvas"),(function(e){if(e.width>0){var t=e.parentNode.style.opacity;l.globalAlpha=""===t?1:Number(t);var n=e.style.transform.match(/^matrix\(([^\(]*)\)$/)[1].split(",").map(Number);CanvasRenderingContext2D.prototype.setTransform.apply(l,n),l.drawImage(e,0,0)}})),navigator.msSaveBlob?navigator.msSaveBlob(u.msToBlob(),"map.png"):o=u.toDataURL(),a.props.saveErguulPlace(e,t,n,o,r)}))}},{key:"sendErguuleg",value:function(e,t,n,r){var o=this.extent;this.map.getView().fit(o,{padding:[200,200,200,200]}),this.downloadImage(e,t,n,r)}},{key:"removeFeatureFromSource",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=this.vector_layer.getSource(),r=n.getFeatures();if(null!=r&&r.length>0)for(var o=0;o<r.length;o++){var a=r[o].getProperties(),i=a.id,u=void 0,c=r[o].getGeometry().getType();if(i==e&&("only_aimag"==t&&c.includes("Polygon")?u=r[o]:t||"LineString"!=c||(u=r[o])),u){n.removeFeature(u);break}}}},{key:"readFeature",value:function(e){var t="aimag_sum";this.removeFeatureFromSource(t,"only_aimag");var n=this.vector_layer.getSource(),r=(new S.a).readFeatures(e,{dataProjection:this.state.projection_data,featureProjection:this.state.projection_display})[0];n.addFeature(r),r.setProperties({id:t}),this.map.getView().fit(r.getGeometry(),{padding:[50,50,50,50],duration:2e3})}},{key:"readFeatures",value:function(e){var t=this,n=this.vector_layer.getSource();e.features.length>0&&(e.features.map((function(e,r){if(e!=={}){var o=(new S.a).readFeatures(e,{dataProjection:t.state.projection_data,featureProjection:t.state.projection_display})[0],a=o.getProperties(),i=t.getFullName(o),u=t.featureWithTextStyle(i);a.is_erguul&&(t.props.is_admin||(t.start_coordinate=o.getGeometry().getCoordinates()),u=t.featureWithTextStyle(i,"green")),t.props.is_admin||a.is_erguul||(t.end_coordinates=o.getGeometry().getCoordinates()),o.setStyle(u),n.addFeature(o)}})),this.makeLineString(e.features))}},{key:"render",value:function(){return o.a.createElement("div",{id:"map",style:{height:"calc( 90vh - 85px - 15px)"}})}}])&&U(t.prototype,n),r&&U(t,r),j}(r.Component),K=n(59);function Q(e){return(Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function X(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ee(e,t,n){return t&&Z(e.prototype,t),n&&Z(e,n),e}function te(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ne(e,t)}function ne(e,t){return(ne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ie(e);if(t){var o=ie(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return oe(this,n)}}function oe(e,t){return!t||"object"!==Q(t)&&"function"!=typeof t?ae(e):t}function ae(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ie(e){return(ie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ue=function(e){te(n,e);var t=re(n);function n(e){var r;return X(this,n),(r=t.call(this,e)).input_data={},r.state={input_value:""},r}return ee(n,[{key:"componentDidMount",value:function(){this.props.value&&this.setState({input_value:this.props.value})}},{key:"handleOnChange",value:function(e){var t=this.props,n=t.idx,r=(t.ix,t.field,t.length,t.origin_name);this.setState({input_value:e}),this.props.getValues(e,n,r)}},{key:"render",value:function(){var e=this,t=this.props,n=t.idx,r=(t.ix,t.field),a=t.length,i=t.choices,u=t.value,c=t.disabled,l=t.type,s=t.is_detail,f=this.state.input_value;return o.a.createElement("div",{className:"form-group animated slideInLeft"},o.a.createElement("dt",null,r),s?o.a.createElement("dd",null,u):"date"==l&&null==i?o.a.createElement("input",{type:l,maxLength:a,className:"form-control",disabled:c,value:f,onChange:function(t){return e.handleOnChange(t.target.value)}}):a>1900&&null==i?o.a.createElement("textarea",{className:"form-control",rows:"3",onChange:function(t){return e.handleOnChange(t.target.value)},maxLength:a,disabled:c,placeholder:r+" оруулна уу",value:f}):a<1900&&null==i?o.a.createElement("input",{type:"text",maxLength:a,className:"form-control",disabled:c,value:f,onChange:function(t){return e.handleOnChange(t.target.value)},placeholder:r+" оруулна уу"}):null!==i?o.a.createElement("select",{className:"form-control",disabled:c,onChange:function(t){return e.handleOnChange(t.target.value)},value:f},o.a.createElement("option",{key:n,value:""},"--- Сонгоно уу ---"),i.map((function(e,t){return o.a.createElement("option",{key:t,value:e[0]},e[1])}))):null)}}]),n}(r.Component),ce=function(e){te(n,e);var t=re(n);function n(e){var r;return X(this,n),(r=t.call(this,e)).state={fields:[],id:"",values:{}},r.getField=r.getField.bind(ae(r)),r.getValues=r.getValues.bind(ae(r)),r}return ee(n,[{key:"componentDidMount",value:function(){this.getField()}},{key:"getField",value:function(){var e=this;J.a.getFieldTailbar().then((function(t){var n=t.success,r=t.fields,o=t.id;n&&e.setState({fields:r,id:o})}))}},{key:"getValues",value:function(e,t,n){var r=this.state.values;r[n]=e,this.setState({values:r})}},{key:"render",value:function(){var e=this,t=this.state,n=t.fields,r=t.values,a=t.id,i=this.props.is_empty;return o.a.createElement("div",null,o.a.createElement("h5",{className:"text-center"},"Эргүүлд гарсан мэдээлэл"),n.map((function(t,n){return o.a.createElement(ue,{key:n,field:t.name,length:t.length,disabled:!!i||t.disabled,idx:n,origin_name:t.origin_name,getValues:e.getValues,value:t.value,choices:t.choices,type:t.type})})),o.a.createElement("div",null,o.a.createElement("button",{className:"btn btn-primary btn-block",disabled:i,onClick:function(){return e.props.saveErguulTailbar(r,a)}},a?"Засах":"Хадгалах")))}}]),n}(r.Component),le=n(888);function se(e){return(se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pe(e,t){return(pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function de(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=he(e);if(t){var o=he(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return me(this,n)}}function me(e,t){return!t||"object"!==se(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function he(e){return(he=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ye=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pe(e,t)}(i,e);var t,n,r,a=de(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=a.call(this,e)).state={"талбарууд":[{field:"fullname",title:"Хэрэглэгчийн овог, нэр"},{field:"part_time",title:"Ээлж",has_action:!0},{field:"state",title:"Төлөв",has_action:!0},{field:"date_start",title:"Эхлэх огноо"},{field:"date_end",title:"Дуусах огноо"}],"жагсаалтын_холбоос":"/gov/api/role/employee/erguul-list/","хувьсах_талбарууд":[{field:"part_time",action:t.getPartTime,action_type:!0},{field:"state",action:t.getState,action_type:!0}]},t}return t=i,(n=[{key:"getState",value:function(e){return{"Гараагүй":"text-danger","Гарсан":"text-success","Гарч байгаа":"text-warning"}[e]}},{key:"getPartTime",value:function(e){return{"Үдээс хойш":"text-dark","Үдээс өмнө":"text-warning"}[e]}},{key:"render",value:function(){var e=this.state,t=e.талбарууд,n=e.жагсаалтын_холбоос,r=e.хувьсах_талбарууд;return o.a.createElement("div",null,o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-lg-12"},o.a.createElement(le.a,{"талбарууд":t,"жагсаалтын_холбоос":n,per_page:100,"уншиж_байх_үед_зурвас":"Уншиж байна","хоосон_байх_үед_зурвас":"Хоосон байна","хувьсах_талбарууд":r}))))}}])&&fe(t.prototype,n),r&&fe(t,r),i}(r.Component);function ge(e){return(ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function be(e,t){return(be=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _e(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=we(e);if(t){var o=we(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Oe(this,n)}}function Oe(e,t){return!t||"object"!==ge(t)&&"function"!=typeof t?Ee(e):t}function Ee(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function we(e){return(we=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Se=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&be(e,t)}(i,e);var t,n,r,a=_e(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=a.call(this,e)).state={points:[],feature:{},is_loading:!0,is_empty:!1,infos:[],is_open:!1},t.getAddresses=t.getAddresses.bind(Ee(t)),t.saveErguulTailbar=t.saveErguulTailbar.bind(Ee(t)),t.handleOpen=t.handleOpen.bind(Ee(t)),t}return t=i,(n=[{key:"componentDidMount",value:function(){this.getAddresses()}},{key:"getAddresses",value:function(){var e=this;J.a.getErguul().then((function(t){var n=t.success,r=t.points;if(n){var o=!1;(r.length>0||r.features.length<2)&&(o=!0),e.setState({points:r,is_empty:o,is_loading:!1})}}))}},{key:"saveErguulTailbar",value:function(e,t){var n=this;this.setState({is_loading:!0}),J.a.saveTailbar(e,t).then((function(e){e.success;var t=e.info;alert(t),n.setState({is_loading:!1})})).catch((function(e){alert("Алдаа гарсан байна"),n.setState({is_loading:!1})}))}},{key:"handleOpen",value:function(){this.setState({is_open:!this.state.is_open})}},{key:"render",value:function(){var e=this,t=this.state,n=t.points,r=t.is_loading,a=t.is_empty,i=t.infos,u=t.is_open;return this.props.employee.is_admin,o.a.createElement("div",{className:"card"},o.a.createElement("div",{className:"card-body"},o.a.createElement(K.a,{is_loading:r}),o.a.createElement("button",{className:"btn gp-outline-primary",onClick:this.handleOpen},u?"Эргүүлд гарсан мэдээлэл":"Эргүүлд гарсан ажилчдын мэдээлэл"),o.a.createElement("br",null),o.a.createElement("br",null),u?o.a.createElement(ye,null):o.a.createElement("div",null,o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-4"},o.a.createElement(ce,{is_empty:a,infos:i,saveErguulTailbar:function(){return e.saveErguulTailbar.apply(e,arguments)}})),o.a.createElement("div",{className:"col-8"},o.a.createElement($,{features:n,is_admin:!1}))))))}}])&&ve(t.prototype,n),r&&ve(t,r),i}(r.Component);function je(e){return(je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fe(e,t){return(Fe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Te(e);if(t){var o=Te(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ne(this,n)}}function Ne(e,t){return!t||"object"!==je(t)&&"function"!=typeof t?Re(e):t}function Re(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Te(e){return(Te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var De=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fe(e,t)}(i,e);var t,n,r,a=xe(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=a.call(this,e)).state={aimag:[],sum:[],horoo:[],aimag_id:-1,sum_id:-1,horoo_id:-1,aimag_name:"",sum_name:"",horoo_name:"",aimag_geo_id:"",sum_geo_id:"",horoo_geo_id:""},t.handleChange=t.handleChange.bind(Re(t)),t.getGeom=t.getGeom.bind(Re(t)),t.getFieldValues=t.getFieldValues.bind(Re(t)),t}return t=i,(n=[{key:"getGeom",value:function(e){var t=this;J.a.getGeom(e).then((function(e){var n=e.feature;n&&t.props.sendFeature(n)}))}},{key:"getFieldValues",value:function(){var e=this;J.a.formOptions().then((function(t){var n=t.success,r=t.info;n&&e.setState({aimag:r})}))}},{key:"componentDidMount",value:function(){this.getFieldValues()}},{key:"handleChange",value:function(e,t,n,r,o){var a,i=t+"_id",u=t+"_geo_id",c=t+"_name",l=e.target.value,s=Object();if("-1"!==l){var f=this.state[t][l];this.setState(Pe({},n,f.children)),n&&(s[n]=f.children),a=f.geo_id,r.map((function(e,t){var n=e+"_geo_id",r=e+"_name";s[e+"_id"]=-1,s[n]="",s[r]=""})),s[u]=a,s[c]=f.name,this.getGeom(a)}else{if(r.length>0&&r.map((function(e,t){var n=e+"_id",r=e+"_geo_id",o=e+"_name";s[e]=[],s[n]=-1,s[r]="",s[o]=""})),"mongol"!==o){var p=o+"_id",d=this.state[p];a=this.state[o][d].geo_id}else a="au_496";s[u]=a,this.getGeom(a)}this.setState(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ke(Object(n),!0).forEach((function(t){Pe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}(Pe({},i,l),s))}},{key:"render",value:function(){var e=this,t=this.state,n=t.aimag,r=t.sum,a=t.horoo,i=t.aimag_id,u=t.sum_id,c=t.horoo_id;return o.a.createElement("div",{className:"form-row"},o.a.createElement("div",{className:"form-group col-4"},o.a.createElement("label",{htmlFor:"aimag"},"Аймаг/Хот:"),o.a.createElement("select",{id:"aimag",className:"form-control","aria-label":"Default select example",onChange:function(t){return e.handleChange(t,"aimag","sum",["sum","horoo"],"mongol")},value:i},o.a.createElement("option",{value:"-1"},"--- Аймаг/Хот сонгох ---"),n.map((function(e,t){return o.a.createElement("option",{key:t,value:t},e.name)})))),o.a.createElement("div",{className:"form-group col-4"},o.a.createElement("label",{htmlFor:"sum"},"Сум/Дүүрэг:"),o.a.createElement("select",{id:"sum",className:"form-control",onChange:function(t){return e.handleChange(t,"sum","horoo",["horoo"],"aimag")},value:u},o.a.createElement("option",{value:"-1"},"--- Сум/Дүүрэг сонгох ---"),r.map((function(e,t){return o.a.createElement("option",{key:t,value:t},e.name)})))),o.a.createElement("div",{className:"form-group col-4"},o.a.createElement("label",{htmlFor:"horoo"},"Хороо/Баг:"),o.a.createElement("select",{id:"horoo",className:"form-control",onChange:function(t){return e.handleChange(t,"horoo",void 0,[],"sum")},value:c},o.a.createElement("option",{value:"-1"},"--- Баг/Хороо сонгох ---"),a.map((function(e,t){return o.a.createElement("option",{key:t,value:t},e.name)})))))}}])&&Ce(t.prototype,n),r&&Ce(t,r),i}(r.Component);function Le(e){return(Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ve(e,t){return(Ve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ge(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Je(e);if(t){var o=Je(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Me(this,n)}}function Me(e,t){return!t||"object"!==Le(t)&&"function"!=typeof t?Ie(e):t}function Ie(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Je(e){return(Je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ze=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ve(e,t)}(i,e);var t,n,r,a=Ge(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=a.call(this,e)).state={points:[],feature:{},is_loading:!0,is_empty:!1},t.getAddresses=t.getAddresses.bind(Ie(t)),t.getFeature=t.getFeature.bind(Ie(t)),t.saveErguulPlace=t.saveErguulPlace.bind(Ie(t)),t.saveErguulTailbar=t.saveErguulTailbar.bind(Ie(t)),t.setLoading=t.setLoading.bind(Ie(t)),t}return t=i,(n=[{key:"componentDidMount",value:function(){this.getAddresses()}},{key:"getAddresses",value:function(){var e=this;J.a.getAddresses().then((function(t){var n=t.success,r=t.points;if(n){var o=!1;r.features.length<2&&(o=!0),e.setState({points:r,is_loading:!1,is_empty:o})}}))}},{key:"getFeature",value:function(e){this.setState({feature:e})}},{key:"getPoint",value:function(e){var t=e;return"string"==typeof e&&(t=e.split(",")),[t[1],t[0]]}},{key:"setLoading",value:function(e){this.setState({is_loading:e})}},{key:"saveErguulPlace",value:function(e,t,n,r,o){var a=this,i=this.getPoint(n);J.a.saveErguul(e,t,i,r,o).then((function(e){var t=e.success,n=e.info;t&&(alert(n),a.setLoading(!1))})).catch((function(e){alert("Алдаа гарсан байна"),a.setLoading(!1)}))}},{key:"saveErguulTailbar",value:function(e){var t=this;this.setLoading(!0),J.a.saveTailbar(e).then((function(e){e.success;var n=e.info;alert(n),t.setLoading(!1)})).catch((function(e){alert("Алдаа гарсан байна"),t.setLoading(!1)}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.points,r=t.feature,a=t.is_loading,i=(t.is_empty,this.props.employee.is_admin);return o.a.createElement("div",{className:"card"},o.a.createElement("div",{className:"card-body"},o.a.createElement(K.a,{is_loading:a}),o.a.createElement("div",{className:"col-12"},o.a.createElement(De,{sendFeature:this.getFeature}),o.a.createElement($,{features:n,feature:r,saveErguulPlace:function(){return e.saveErguulPlace.apply(e,arguments)},is_admin:i,setLoading:this.setLoading}))))}}])&&Ae(t.prototype,n),r&&Ae(t,r),i}(r.Component);function Ue(e){return(Ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function We(){return(We=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Be(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function He(e,t){return(He=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ke(e);if(t){var o=Ke(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return $e(this,n)}}function $e(e,t){return!t||"object"!==Ue(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ke(e){return(Ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Qe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&He(e,t)}(u,e);var t,n,r,i=Ye(u);function u(){return Be(this,u),i.apply(this,arguments)}return t=u,(n=[{key:"render",value:function(){var e=this.props.employee;return o.a.createElement(a.c,null,o.a.createElement(a.a,{path:"/gov/perm/addresses/",component:function(t){return o.a.createElement(ze,We({},t,{employee:e}))}}),o.a.createElement(a.a,{exact:!0,path:"/gov/perm/erguuleg/",component:function(t){return o.a.createElement(Se,We({},t,{employee:e}))}}))}}])&&qe(t.prototype,n),r&&qe(t,r),u}(r.Component)}}]);